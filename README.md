# ğŸ¨ NFractional: NFT Fractionalization Platform on Flow

> **Transform any NFT into tradeable shares** â€” A complete DeFi platform showcasing Flow's revolutionary Actions primitives

> ğŸ’¡ **VIBE-CODED**: ğŸ¦¾ All code in this project was generated by _GPT-5_ and _Composer-1_ models! This repo is  thoroughly strung together with good vibes, coffee, and Flow Actions. ğŸ¨âš¡ï¸ğŸ§ƒ

[![Flow](https://img.shields.io/badge/Flow-00D4FF?style=flat&logo=flow&logoColor=white)](https://flow.com)
[![Cadence](https://img.shields.io/badge/Cadence-1.0-blue)](https://cadence-lang.org)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue)](https://www.typescriptlang.org)
[![Next.js](https://img.shields.io/badge/Next.js-15-black)](https://nextjs.org)

"NFractional" is a production-ready NFT fractionalization platform built on Flow blockchain. It empowers creators to split their NFTs into fungible share tokens, enabling liquidity, governance, and innovative DeFi experiencesâ€”all powered by Flow's cutting-edge Actions (DeFi Primitives).

---

## âœ¨ Features

### ğŸ›ï¸ **Vault System**

- Create fractionalized vaults from any NFT
- Secure custody with LockBox pattern
- Configurable policies and max supply
- Multi-NFT support ready

### ğŸ’ **Share Tokens**

- Fungible tokens per vault (VaultShareToken contracts)
- Transfer controls and modes
- Minting with policy enforcement
- Full FungibleToken standard compliance

### ğŸ“Š **Marketplace**

- Create, cancel, and fill listings
- Direct peer-to-peer trading
- Fee management with vault/platform splits
- Scheduled fee parameter updates

### ğŸ’§ **Liquidity Pools**

- Constant Product AMM integration
- Swap shares for FLOW/USDC
- Add/remove liquidity
- Fee routing via Flow Actions

### ğŸ“ˆ **Distributions**

- Schedule dividend/stream programs
- Claim accrued payouts
- Time-windowed distributions
- Per-holder claim tracking

### ğŸ—³ï¸ **Governance** (TODO)

- Propose buyouts with custom terms
- Weighted voting (quorum & support thresholds)
- Redemption workflows
- Transfer mode controls

### ğŸ”„ **Event-Driven Architecture**

- Real-time blockchain event ingestion
- Normalized event pipeline
- Indexed data persistence
- Full observability stack

## ğŸ—ï¸ Architecture

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Flow Blockchain                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Fractional   â”‚ â”‚  VaultShareToken   â”‚ â”‚        AMM         â”‚    â”‚
â”‚  â”‚   Contract    â”‚ â”‚    Contracts       â”‚ â”‚    Contracts       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Events
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Backend Services                             â”‚
â”‚                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚ Ingestor  â”‚â”€â”€â–¶â”‚ Normalizer â”‚â”€â”€â–¶â”‚  Indexer  â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚        â”‚               â”‚                â”‚                          â”‚
â”‚        â”‚               â”‚                â”‚                          â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                        NATS JetStream                             â”‚
â”‚                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚    API     â”‚â—€â”€â”€â”‚ Distributor  â”‚                                 â”‚
â”‚   â”‚  GraphQL   â”‚   â”‚   Service    â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚        â”‚                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Storage Layer                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚   â”‚ ScyllaDB â”‚   â”‚ Prometheus â”‚   â”‚  Grafana  â”‚                    â”‚
â”‚   â”‚ (Events) â”‚   â”‚ (Metrics)  â”‚   â”‚(Dashboards)â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Next.js Frontend (Web)                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚  Pages    â”‚   â”‚ Components  â”‚   â”‚  Hooks    â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Smart Contracts** (`flow/cadence/`)

- `Fractional.cdc` â€” Core vault and governance logic
- `VaultShareToken.cdc` â€” Per-vault fungible token contracts
- `ConstantProductAMM.cdc` â€” AMM pool implementation
- `FeeRouter.cdc` â€” Fee routing and distribution
- Built with **Cadence 1.0** syntax

### **Backend Services** (`services/`)

| Service | Purpose | Tech |
|---------|---------|------|
| **api** | GraphQL API gateway | Node.js, Apollo Server |
| **ingestor** | Flow event ingestion | Flow Access API, NATS |
| **normalizer** | Event normalization | NATS JetStream |
| **indexer** | Persistent indexing | ScyllaDB, CQL |
| **distributor** | Distribution execution | Cadence transactions |

### **Frontend** (`web/`)

- **Next.js 15** with App Router
- **React 19** with Server Components
- **TypeScript** throughout
- **TailwindCSS** for styling
- **@onflow/react-sdk** for wallet integration

### **Infrastructure** (`infra/`)

- **NATS JetStream** â€” Event streaming
- **ScyllaDB** â€” Time-series data storage
- **Prometheus** â€” Metrics collection
- **Grafana** â€” Observability dashboards
- **Docker Compose** â€” Local development

---

## ğŸ“¦ Quick Start

### Prerequisites

- Node.js 20+
- pnpm
- Flow CLI
- Docker & Docker Compose

### 1. Clone & Install

```bash
git clone <your-repo-url>
cd NFractional

## Do this in every directory!
pnpm install
```

### 2. Generate Cadence Packages

```bash
cd packages/cadence
pnpm generate
```

### 3. Start Flow Emulator

```bash
cd flow
flow emulator --init --verbose --contracts
```

In another terminal:

```bash
cd flow
ruby bootstrap-accounts.rb
flow project deploy --network emulator
```

### 4. Setup Admin & Contracts

```bash
# Setup admin resource
flow transactions send flow/cadence/transactions/setup/admin/setup-admin.cdc \
  --network emulator --signer flow-admin --yes

# Initialize scheduler
flow transactions send flow/cadence/transactions/scheduler/admin/init.cdc \
  --network emulator --signer flow-admin --yes
```

### 5. Start Infrastructure

```bash
docker compose up -d
```

This starts:

- NATS + JetStream
- ScyllaDB
- API service (port 4000)
- Indexer & ingestor services
- Prometheus (port 19090)
- Grafana (port 3000)

### 6. Start Web App

```bash
cd web
pnpm dev
```

Visit <http://localhost:3001>

### 7. Verify Setup

```bash
# Check API health
curl http://localhost:4000/graphiql

```

---

## ğŸ“ Project Structure

```text
flow-hackathon/
â”œâ”€â”€ flow/                    # Flow smart contracts
â”‚   â”œâ”€â”€ cadence/
â”‚   â”‚   â”œâ”€â”€ contracts/       # Core contracts
â”‚   â”‚   â”œâ”€â”€ scripts/         # Read-only queries
â”‚   â”‚   â””â”€â”€ transactions/    # State-changing txs
â”‚   â””â”€â”€ flow.json            # Flow config
â”‚
â”œâ”€â”€ services/                # Backend microservices
â”‚   â”œâ”€â”€ api/                 # GraphQL API
â”‚   â”œâ”€â”€ ingestor/            # Event ingestion
â”‚   â”œâ”€â”€ normalizer/          # Event normalization
â”‚   â”œâ”€â”€ indexer/             # DB indexing
â”‚   â””â”€â”€ distributor/         # Distribution executor
â”‚
â”œâ”€â”€ web/                     # Next.js frontend
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ app/             # App Router pages
â”‚       â”œâ”€â”€ components/      # React components
â”‚       â””â”€â”€ lib/              # Utilities & hooks
â”‚
â”œâ”€â”€ infra/                   # Infrastructure configs
â”‚   â”œâ”€â”€ nats/                # NATS/JetStream setup
â”‚   â”œâ”€â”€ scylla/              # ScyllaDB schema
â”‚   â”œâ”€â”€ prometheus/          # Metrics config
â”‚   â””â”€â”€ grafana/             # Dashboard configs
â”‚
â””â”€â”€ packages/                # Shared packages
    â””â”€â”€ cadence/             # Cadence codegen
```

---

## ğŸ” Key Designs

### **Resource-Oriented Programming**

- NFTs remain in user custody (`LockBox`)
- Vault metadata tracks ownership
- No central escrow wallet

### **Event-Driven Indexing**

- Ingest â†’ Normalize â†’ Index pipeline
- Idempotent consumers
- Checkpoint-based recovery

### **Actions Over Custom Logic**

- Use Flow Actions for swaps, fee routing
- Compose DeFi primitives
- Reduce custom code surface

### **Financial Accuracy**

- All numbers represent true balances
- Decimal.js for precise calculations
- No rounding errors in UI

---

## ğŸ§ª Testing (TODO)

### Flow Emulator Tests

```bash
cd flow
flow test
```

## ğŸ“Š Observability

- **Prometheus**: `http://localhost:19090`
- **Grafana**: `http://localhost:3000` (admin/admin)
- **NATS Surveyor**: `http://localhost:7777`

Metrics exposed:

- Request latencies
- Event ingestion rates
- Indexer lag
- Transaction success rates

## ğŸ”® Future Enhancements

Only your imagination can stop you

- [ ] Multi-NFT vaults (baskets)
- [ ] Delegated voting
- [ ] Advanced quorum models
- [ ] Cross-vault swaps
- [ ] Yield farming integrations
- [ ] Mobile app (React Native)
- [ ] Governance

---

## ğŸ¤ Contributing

This is a FLOW hackathon project, but contributions are welcome!

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Submit a pull request

---

## ğŸ“„ License

MIT

---

## ğŸ™ Acknowledgments

- **Flow Foundation** for Actions primitives
- **Flow community** for excellent tooling
- **FLow Developer Discord** And the Flow devs who unblocked me in real-time!

---

## ğŸŒŸ Built With

- [Flow Blockchain](https://flow.com)
- [Cadence](https://cadence-lang.org)
- [Next.js](https://nextjs.org)
- [NATS](https://nats.io)
- [ScyllaDB](https://www.scylladb.com)
- [Docker](https://www.docker.com)

---

## â¤ï¸ Made for Flow FORTE Hackathon
